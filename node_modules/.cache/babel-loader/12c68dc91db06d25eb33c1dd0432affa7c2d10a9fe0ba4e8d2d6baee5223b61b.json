{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{getAllQuotes}from'../services/firebaseService';import{filterQuotesByPeriod}from'../utils/dateUtils';import PeriodFilter from'./PeriodFilter';import FilterTable from'./FilterTable';import InterventionStats from'./InterventionStats';import LoadingSpinner from'./LoadingSpinner';import'../styles/Dashboard.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Dashboard=()=>{const[quotes,setQuotes]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[period,setPeriod]=useState('');const[selectedDate,setSelectedDate]=useState(new Date().toISOString().split('T')[0]);const[viewMode,setViewMode]=useState('stats');// 'stats' ou 'table'\n// Charger les devis au montage du composant\nuseEffect(()=>{const fetchQuotes=async()=>{try{setLoading(true);const data=await getAllQuotes();setQuotes(data);setError(null);}catch(err){setError('Erreur lors du chargement des donnÃ©es.  Veuillez rÃ©essayer.');console.error(err);}finally{setLoading(false);}};fetchQuotes();},[]);// Filtrer les devis selon la pÃ©riode sÃ©lectionnÃ©e\nconst filteredQuotes=useMemo(()=>{return filterQuotesByPeriod(quotes,period,selectedDate);},[quotes,period,selectedDate]);// Statistiques globales\nconst stats=useMemo(()=>{return{total:filteredQuotes.length,totalFilters:filteredQuotes.reduce((sum,quote)=>{const filterKeys=Object.keys(quote).filter(key=>(key.startsWith('LP')||key.startsWith('LM'))&&typeof quote[key]==='number');return sum+filterKeys.reduce((s,key)=>s+(quote[key]||0),0);},0)};},[filteredQuotes]);const handleReset=()=>{setPeriod('');setSelectedDate(new Date().toISOString().split('T')[0]);};if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCCA Tableau de Filtres - HeroTool\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Gestion et suivi des filtres automobiles\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"view-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(viewMode==='stats'?'active':''),onClick:()=>setViewMode('stats'),children:\"\\uD83D\\uDCCA Statistiques\"}),/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(viewMode==='table'?'active':''),onClick:()=>setViewMode('table'),children:\"\\uD83D\\uDCCB Tableau d\\xE9taill\\xE9\"})]}),viewMode==='stats'?/*#__PURE__*//* Vue Statistiques */_jsx(InterventionStats,{quotes:quotes}):/*#__PURE__*//* Vue Tableau */_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stats-cards\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Devis\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.total})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Filtres\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat-value\",children:stats.totalFilters})]})]}),/*#__PURE__*/_jsx(PeriodFilter,{period:period,setPeriod:setPeriod,selectedDate:selectedDate,setSelectedDate:setSelectedDate,onReset:handleReset}),/*#__PURE__*/_jsx(FilterTable,{quotes:filteredQuotes})]})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useMemo","getAllQuotes","filterQuotesByPeriod","PeriodFilter","FilterTable","InterventionStats","LoadingSpinner","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","quotes","setQuotes","loading","setLoading","error","setError","period","setPeriod","selectedDate","setSelectedDate","Date","toISOString","split","viewMode","setViewMode","fetchQuotes","data","err","console","filteredQuotes","stats","total","length","totalFilters","reduce","sum","quote","filterKeys","Object","keys","filter","key","startsWith","s","handleReset","className","children","concat","onClick","onReset"],"sources":["/home/runner/work/HeroBase/HeroBase/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { getAllQuotes } from '../services/firebaseService';\nimport { filterQuotesByPeriod } from '../utils/dateUtils';\nimport PeriodFilter from './PeriodFilter';\nimport FilterTable from './FilterTable';\nimport InterventionStats from './InterventionStats';\nimport LoadingSpinner from './LoadingSpinner';\nimport '../styles/Dashboard.css';\n\nconst Dashboard = () => {\n  const [quotes, setQuotes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [period, setPeriod] = useState('');\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [viewMode, setViewMode] = useState('stats'); // 'stats' ou 'table'\n\n  // Charger les devis au montage du composant\n  useEffect(() => {\n    const fetchQuotes = async () => {\n      try {\n        setLoading(true);\n        const data = await getAllQuotes();\n        setQuotes(data);\n        setError(null);\n      } catch (err) {\n        setError('Erreur lors du chargement des donnÃ©es.  Veuillez rÃ©essayer.');\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchQuotes();\n  }, []);\n\n  // Filtrer les devis selon la pÃ©riode sÃ©lectionnÃ©e\n  const filteredQuotes = useMemo(() => {\n    return filterQuotesByPeriod(quotes, period, selectedDate);\n  }, [quotes, period, selectedDate]);\n\n  // Statistiques globales\n  const stats = useMemo(() => {\n    return {\n      total: filteredQuotes.length,\n      totalFilters: filteredQuotes.reduce((sum, quote) => {\n        const filterKeys = Object.keys(quote).filter(key => \n          (key.startsWith('LP') || key.startsWith('LM')) && typeof quote[key] === 'number'\n        );\n        return sum + filterKeys.reduce((s, key) => s + (quote[key] || 0), 0);\n      }, 0)\n    };\n  }, [filteredQuotes]);\n\n  const handleReset = () => {\n    setPeriod('');\n    setSelectedDate(new Date().toISOString().split('T')[0]);\n  };\n\n  if (loading) {\n    return <LoadingSpinner />;\n  }\n\n  if (error) {\n    return <div className=\"error-message\">{error}</div>;\n  }\n\n  return (\n    <div className=\"dashboard\">\n      <header className=\"dashboard-header\">\n        <h1>ðŸ“Š Tableau de Filtres - HeroTool</h1>\n        <p>Gestion et suivi des filtres automobiles</p>\n      </header>\n\n      {/* Toggle entre vues */}\n      <div className=\"view-toggle\">\n        <button\n          className={`toggle-btn ${viewMode === 'stats' ? 'active' : ''}`}\n          onClick={() => setViewMode('stats')}\n        >\n          ðŸ“Š Statistiques\n        </button>\n        <button\n          className={`toggle-btn ${viewMode === 'table' ? 'active' : ''}`}\n          onClick={() => setViewMode('table')}\n        >\n          ðŸ“‹ Tableau dÃ©taillÃ©\n        </button>\n      </div>\n\n      {viewMode === 'stats' ? (\n        /* Vue Statistiques */\n        <InterventionStats quotes={quotes} />\n      ) : (\n        /* Vue Tableau */\n        <>\n          <div className=\"stats-cards\">\n            <div className=\"stat-card\">\n              <h3>Devis</h3>\n              <p className=\"stat-value\">{stats.total}</p>\n            </div>\n            <div className=\"stat-card\">\n              <h3>Total Filtres</h3>\n              <p className=\"stat-value\">{stats.totalFilters}</p>\n            </div>\n          </div>\n\n          <PeriodFilter\n            period={period}\n            setPeriod={setPeriod}\n            selectedDate={selectedDate}\n            setSelectedDate={setSelectedDate}\n            onReset={handleReset}\n          />\n\n          <FilterTable quotes={filteredQuotes} />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}